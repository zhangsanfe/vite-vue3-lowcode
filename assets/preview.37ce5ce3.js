var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n;import{f as r,h as i,j as c,P as u,k as p,I as d,L as m,l as f,m as v,w as g,n as y,v as b}from"./visual.config.4ff975d7.js";import{l as O,b as h,y as C,d as w,w as S,x as k,q as j,B as P,I as _,m as x,t as N,g as T,o as $,e as z,ai as B,aD as I,f as D,H as E,C as A,$ as L}from"./preload-helper.1969ef4b.js";import{u as M}from"./useAnimate.644289ba.js";import{r as R}from"./preview.2f42c37b.js";var H=0;var[K,U]=p("toast"),q=w({name:K,props:{icon:String,show:Boolean,overlay:Boolean,message:[Number,String],iconSize:[Number,String],className:c,iconPrefix:String,loadingType:String,forbidClick:Boolean,overlayClass:c,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,type:{type:String,default:"text"},duration:{type:Number,default:2e3},position:{type:String,default:"middle"},transition:{type:String,default:"van-fade"}},emits:["update:show"],setup(e,{emit:t}){var o,n=!1,l=()=>{var t=e.show&&e.forbidClick;n!==t&&((n=t)?(H||document.body.classList.add("van-toast--unclickable"),H++):H&&(--H||document.body.classList.remove("van-toast--unclickable")))},a=e=>t("update:show",e),s=()=>{e.closeOnClick&&a(!1)},r=()=>{clearTimeout(o)},i=()=>{var{icon:t,type:o,iconSize:n,iconPrefix:l,loadingType:a}=e;return t||"success"===o||"fail"===o?P(d,{name:t||o,size:n,class:U("icon"),classPrefix:l},null):"loading"===o?P(m,{class:U("loading"),size:n,type:a},null):void 0},c=()=>{var{type:t,message:o}=e;if(f(o)&&""!==o)return"html"===t?P("div",{class:U("text"),innerHTML:String(o)},null):P("div",{class:U("text")},[o])};return S((()=>[e.show,e.forbidClick]),l),S((()=>[e.show,e.type,e.message,e.duration]),(()=>{r(),e.show&&e.duration>0&&(o=setTimeout((()=>{a(!1)}),e.duration))})),k(l),j(l),()=>P(u,_({show:e.show,class:[U([e.position,{[e.type]:!e.icon}]),e.className],overlay:e.overlay,lockScroll:!1,transition:e.transition,overlayClass:e.overlayClass,overlayStyle:e.overlayStyle,closeOnClickOverlay:e.closeOnClickOverlay,onClick:s,onClosed:r},{"onUpdate:show":a}),{default:()=>[i(),c()]})}}),G={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1},J=[],Y=!1,F=r({},G),Q={};function V(e){return y(e)?e:{message:e}}function W(){var e,t,{instance:o,unmount:n}=(e=O({setup(){var e=x(""),{open:t,state:l,close:a,toggle:s}=function(){var e=h({show:!1}),t=t=>{e.show=t},o=o=>{r(e,o),C((()=>t(!0)))},n=()=>t(!1);return i({open:o,close:n,toggle:t}),{open:o,close:n,state:e,toggle:t}}(),c=()=>{Y&&(J=J.filter((e=>e!==o)),n())};return N().render=()=>{var t={onClosed:c,"onUpdate:show":s};return e.value&&(t.message=e.value),P(q,_(l,t),null)},{open:t,clear:a,message:e}}}),t=document.createElement("div"),document.body.appendChild(t),{instance:e.mount(t),unmount(){e.unmount(),document.body.removeChild(t)}});return o}function X(e={}){if(!v)return{};var t=function(){if(!J.length||Y){var e=W();J.push(e)}return J[J.length-1]}(),o=V(e);return t.open(r({},F,Q[o.type||F.type],o)),t}var Z=e=>t=>X(r({type:e},V(t)));X.loading=Z("loading"),X.success=Z("success"),X.fail=Z("fail"),X.clear=e=>{J.length&&(e?(J.forEach((e=>{e.clear()})),J=[]):Y?J.shift().clear():J[0].clear())},X.setDefaultOptions=function(e,t){"string"==typeof e?Q[e]=t:r(F,e)},X.resetDefaultOptions=e=>{"string"==typeof e?Q[e]=null:(F=r({},G),Q={})},X.allowMultiple=(e=!0)=>{Y=e},X.install=e=>{e.use(g(q)),e.config.globalProperties.$toast=X};var ee=w({name:"CompRender",props:{element:{type:Object,default:()=>({})},config:{type:Object,default:()=>({})}},setup:e=>()=>e.config.componentMap[e.element.componentKey].render({size:{},props:e.element.props||{},model:{},block:e.element,custom:{}})}),te=w({name:"SlotItem",components:{CompRender:ee},props:{element:{type:[Object],default:()=>({})},config:{type:Object,default:()=>({})}},setup:e=>(k((()=>{var t,o,n;const l=e.element.animations;if(null==l?void 0:l.length){let a=null!=(o=null==(t=window.$$refs[e.element._vid])?void 0:t.$el)?o:window.$$refs[e.element._vid];a=null==(n=null==a?void 0:a.closest(".__slot-item"))?void 0:n.firstChild,a&&M(a,l)}})),{})});const oe={class:"__slot-item"};te.render=function(e,t,o,n,l,a){var s;const r=T("slot-item",!0),i=T("comp-render");return $(),z("div",oe,[P(i,{element:e.element,config:e.config},B({_:2},[I(null==(s=e.element.props)?void 0:s.slots,((t,o)=>({name:o,fn:D((()=>[($(!0),z(E,null,I(null==t?void 0:t.children,(t=>($(),z(r,{key:t._vid,element:t,config:e.config},null,8,["element","config"])))),128))]))})))]),1032,["element","config"])])};var ne=w({name:"Preview",components:{SlotItem:te},setup(){var e;const r=JSON.parse(localStorage.getItem(A.PAGE_DATA_KEY));r&&Object.keys(r.pages)||X.fail("当前没有可以预览的页面！");const i=R.currentRoute,c=h({currentPage:null==(e=r.pages[i.value.path])?void 0:e.blocks});return c.currentPage||R.replace("/"),u=((e,t)=>{for(var o in t||(t={}))l.call(t,o)&&s(e,o,t[o]);if(n)for(var o of n(t))a.call(t,o)&&s(e,o,t[o]);return e})({},L(c)),t(u,o({visualConfig:b}));var u}});ne.render=function(e,t,o,n,l,a){const s=T("slot-item");return $(!0),z(E,null,I(e.currentPage,(t=>($(),z(s,{key:t._vid,element:t,config:e.visualConfig},null,8,["element","config"])))),128)};export default ne;
